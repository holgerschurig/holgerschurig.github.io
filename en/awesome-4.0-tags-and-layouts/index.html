<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.82.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta property="og:title" content="AwesomeWM: Tags and Layout setup"><meta name=keywords content="awesome,dotfiles"><meta property="og:title" content="AwesomeWM: Tags and Layout setup"><meta property="og:description" content="In this post I show a nice method to define tags and associated
layouts, where the tag names change dynamically when the layout
changes."><meta property="og:type" content="article"><meta property="og:url" content="http://holgerschurig.github.io/en/awesome-4.0-tags-and-layouts/"><meta property="article:section" content="en"><meta property="article:published_time" content="2017-01-22T00:00:00+00:00"><meta property="article:modified_time" content="2017-01-22T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="AwesomeWM: Tags and Layout setup"><meta name=twitter:description content="In this post I show a nice method to define tags and associated
layouts, where the tag names change dynamically when the layout
changes."><link rel=icon type=image/png href=../../favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=../../favicon-16x16.png sizes=16x16><link rel=stylesheet type=text/css media=screen href=../../css/normalize.css><link rel=stylesheet type=text/css media=screen href=../../css/main.css><link rel=stylesheet type=text/css media=screen href=../../css/all.css><link rel=stylesheet href=../../css/katex.min.css crossorigin=anonymous><script defer src=../../js/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=../../js/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script><title>AwesomeWM: Tags and Layout setup | Holger Schurig's Computer Calisthenics & Orthodontia</title></head><body><header><div id=avatar><a href=http://holgerschurig.github.io/><img src=../../img/vitae.jpg alt="Holger Schurig's Computer Calisthenics & Orthodontia"></a></div><div id=titletext><h2 id=title><a href=http://holgerschurig.github.io/>Holger Schurig's Computer Calisthenics & Orthodontia</a></h2></div><div id=title-description><p id=subtitle></p><div id=social><nav><ul><li><a href=../../index.xml><i title=RSS class="icons fas fa-rss"></i></a></li></ul></nav></div></div><div id=mainmenu><nav><ul><li><a href=../../en>English</a></li><li><a href=../../de>Deutsch</a></li><li><a href=../../tags>Tags</a></li><li><a href=../../topics>Topics</a></li><li><a href=../../impressum>Impressum</a></li></ul></nav></div></header><main><div class=post><div class=author></div><div class=post-header><div class=meta><div class=date><span class=day>22</span>
<span class=rest>Jan 2017</span></div></div><div class=matter><h1 class=title>AwesomeWM: Tags and Layout setup</h1></div></div><div class=markdown><p>In this post I show a nice method to define tags and associated
layouts, where the tag names change dynamically when the layout
changes.</p><p>Note: the following works with AwesomeWM v4.0. I used v4.0-105-gbfb35349.</p><h2 id=current-situation>Current situation</h2><p>When you look at the example <code>rc.lua</code> file, you see that tags and layout setup
is spread over several places.</p><p>First, you have this long list of available layouts:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=color:#888>-- Table of layouts to cover with awful.layout.inc, order matters</span>
awful.layout.layouts <span style=color:#333>=</span> {
    awful.layout.suit.floating,
    awful.layout.suit.tile,
    awful.layout.suit.tile.left,
    awful.layout.suit.tile.bottom,
    awful.layout.suit.tile.top,
    awful.layout.suit.fair,
    awful.layout.suit.fair.horizontal,
    awful.layout.suit.spiral,
    awful.layout.suit.spiral.dwindle,
    awful.layout.suit.max,
    awful.layout.suit.max.fullscreen,
    awful.layout.suit.magnifier,
    awful.layout.suit.corner.nw,
    <span style=color:#888>-- awful.layout.suit.corner.ne,</span>
    <span style=color:#888>-- awful.layout.suit.corner.sw,</span>
    <span style=color:#888>-- awful.layout.suit.corner.se,</span>
}
</code></pre></div><p>and then, where the screens get setup, you see:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=color:#888>-- Each screen has its own tag table.</span>
awful.tag({ <span style=background-color:#fff0f0>&#34;1&#34;</span>, <span style=background-color:#fff0f0>&#34;2&#34;</span>, <span style=background-color:#fff0f0>&#34;3&#34;</span>, <span style=background-color:#fff0f0>&#34;4&#34;</span>, <span style=background-color:#fff0f0>&#34;5&#34;</span>, <span style=background-color:#fff0f0>&#34;6&#34;</span>, <span style=background-color:#fff0f0>&#34;7&#34;</span>, <span style=background-color:#fff0f0>&#34;8&#34;</span>, <span style=background-color:#fff0f0>&#34;9&#34;</span> }, s, awful.layout.layouts[<span style=color:#00d;font-weight:700>1</span>])
</code></pre></div><p>I disliked several things here:</p><ul><li>the numbers aren&rsquo;t telling me much</li><li>when I change the numbers to roles, e.g. &ldquo;www&rdquo;, &ldquo;dev&rdquo;, &ldquo;music&rdquo; I
loose flexibility. Maybe I don&rsquo;t have &ldquo;music&rdquo; at the work, but at
home &mldr;</li><li>as a layout is tightly coupled to a tag, it would probably be better
to reflect the layout in the tag name.</li><li>initializing all tags with the same layout seems unflexible</li></ul><p>So let&rsquo;s work toward a setup that will fit more to my taste.</p><h2 id=define-tags-and-layouts-in-one-go>Define tags and layouts in one go</h2><p>I first define a table that contains which tags I want <strong>and</strong> their
default layout:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=color:#080;font-weight:700>local</span> my_tag_list <span style=color:#333>=</span> {
    awful.layout.suit.fair,
    awful.layout.suit.fair,
    awful.layout.suit.fair,
    awful.layout.suit.floating,
    awful.layout.suit.max,
}
</code></pre></div><p>With this example, I would end up with 5 tags.</p><h2 id=automatically-set-awfullayoutlayouts>Automatically set awful.layout.layouts</h2><p>This is completely optional. If you don&rsquo;t want this, then setup
<code>awful.layout.layouts</code> like in the example rc.lua.</p><p>Awesome needs <code>awful.layout.layouts</code> set. It uses when you
increment/decrement the layout, e.g with the mouse or some keybinding.
Instead of manually setting this up, we can use <code>my_tag_list</code> as a
source for it.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua>awful.layout.layouts <span style=color:#333>=</span> {}
<span style=color:#080;font-weight:700>for</span> _,v <span style=color:#080;font-weight:700>in</span> pairs(my_tag_list) <span style=color:#080;font-weight:700>do</span>
    <span style=color:#080;font-weight:700>if</span> <span style=color:#000;font-weight:700>not</span> awful.util.table.hasitem(awful.layout.layouts, v) <span style=color:#080;font-weight:700>then</span>
        table.insert(awful.layout.layouts, v)
    <span style=color:#080;font-weight:700>end</span>
<span style=color:#080;font-weight:700>end</span>
</code></pre></div><h2 id=attach-tags-and-layouts-to-the-screens>Attach tags and layouts to the screens</h2><p>We can now attach our tags and layouts to the screens:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=color:#888>-- put this inside the `awful.screen.connect_for_each_screen` function:</span>
<span style=color:#080;font-weight:700>for</span> i,l <span style=color:#080;font-weight:700>in</span> ipairs(my_tag_list) <span style=color:#080;font-weight:700>do</span>
    awful.tag.add(i <span style=color:#333>..</span> <span style=background-color:#fff0f0>&#34;:&#34;</span> <span style=color:#333>..</span> shorten_layout_name(l.name),
                  {layout <span style=color:#333>=</span> l,
                   screen <span style=color:#333>=</span> s,
                   selected <span style=color:#333>=</span> i<span style=color:#333>==</span><span style=color:#00d;font-weight:700>1</span>})
<span style=color:#080;font-weight:700>end</span>
</code></pre></div><p>An observant reader will have noticed that I used a function
<code>shorten_layout_name()</code>. That&rsquo;s just because I want my tag/layout
names to be short, e.g. around 4 characters wide.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=color:#080;font-weight:700>function</span> <span style=color:#06b;font-weight:700>shorten_layout_name</span>(name)
    <span style=color:#080;font-weight:700>if</span> name <span style=color:#333>==</span> <span style=background-color:#fff0f0>&#34;fullscreen&#34;</span> <span style=color:#080;font-weight:700>then</span> name <span style=color:#333>=</span> <span style=background-color:#fff0f0>&#34;full&#34;</span>
    <span style=color:#080;font-weight:700>elseif</span> name <span style=color:#333>==</span> <span style=background-color:#fff0f0>&#34;floating&#34;</span> <span style=color:#080;font-weight:700>then</span> name <span style=color:#333>=</span> <span style=background-color:#fff0f0>&#34;float&#34;</span>
    <span style=color:#080;font-weight:700>elseif</span> name <span style=color:#333>==</span> <span style=background-color:#fff0f0>&#34;fairv&#34;</span> <span style=color:#080;font-weight:700>then</span> name <span style=color:#333>=</span> <span style=background-color:#fff0f0>&#34;fair&#34;</span>
    <span style=color:#080;font-weight:700>elseif</span> name <span style=color:#333>==</span> <span style=background-color:#fff0f0>&#34;termfair&#34;</span> <span style=color:#080;font-weight:700>then</span> name <span style=color:#333>=</span> <span style=background-color:#fff0f0>&#34;term&#34;</span> <span style=color:#080;font-weight:700>end</span>
    <span style=color:#080;font-weight:700>return</span> name
<span style=color:#080;font-weight:700>end</span>
</code></pre></div><h2 id=automatically-change-the-tag-names-when-layout-changes>Automatically change the tag names when layout changes</h2><p>The taglist will now look like</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>4:fair 5:fait 6:fair 7:float 8:max
</code></pre></div><p>This will be wrong as soon as I change the layout of a tag. So I need
to react to some signals. Define this function:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=color:#080;font-weight:700>local</span> <span style=color:#080;font-weight:700>function</span> <span style=color:#06b;font-weight:700>tagbox_update_tagname</span>(t)    
    t.name <span style=color:#333>=</span> t.index <span style=color:#333>..</span> <span style=background-color:#fff0f0>&#34;:&#34;</span> <span style=color:#333>..</span> shorten_layout_name(t.layout.name)
<span style=color:#080;font-weight:700>end</span>
</code></pre></div><p>And now just assign this function to two signals:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=color:#888>-- put this inside the `awful.screen.connect_for_each_screen` function:</span>
awful.tag.attached_connect_signal(s, <span style=background-color:#fff0f0>&#34;tagged&#34;</span>, tagbox_update_tagname)
awful.tag.attached_connect_signal(s, <span style=background-color:#fff0f0>&#34;property::layout&#34;</span>, tagbox_update_tagname)
</code></pre></div></div><div class=tags><div class=taxosfloating_left><p>Tags</p></div><div class=termsfloating_right><p><a href=../../tags/awesome/>awesome</a>
<a href=../../tags/dotfiles/>dotfiles</a></p></div><div class=clearit></div><div class=tags><div class=taxosfloating_left><p>Topics</p></div><div class=termsfloating_right><p><a href=../../topics/linux/>linux</a></p></div><div class=clearit></div></div></div></main></body></html>